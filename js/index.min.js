$(document).ready(function(){populateList(loadLocalStorage());$("body").on("submit","#link-form",function(a){a.preventDefault();submit()}).on("click","#page-numbers a",function(a){a.preventDefault();"prev"!=this.name&&"next"!=this.name&&($("#page-numbers a").removeClass("selected"),$(this).addClass("selected"));togglePages(this.name)})});
var loadLocalStorage=function(){var a=window.localStorage.getItem("list");a=JSON.parse(a);if(null==a||"undefined"==a)a={items:[]};return a},populateList=function(a){var b=$(".paginated-container"),d=0,c=0;a.items.forEach(function(e,f){0==f&&b.find("#page-numbers").append('<a id="page-button-prev" target="_self" href="" name="prev"><</a>');f==d&&(c++,b.append('<ul id="page-'+c+'" class="link-list"></ul>'),b.find("#page-numbers").append('<a id="page-button-'+c+'" target="_self" href="" name='+c+" >"+
c+"</a>"),d+=20);f==a.items.length-1&&b.find("#page-numbers").append('<a id="page-button-next" target="_self" href="" name="next">></a>');$(".paginated-container #page-"+c).append('<li><div class="col1">'+f+'</div><div class="col8"><a target="_blank" href="'+e.url+'">'+e.url+'</a></div><div class="col3"><button class="col6" onClick="editItem(\''+e.url+'\')">Edit</button><button class="col6" onClick="removeItem(\''+e.url+"')\">Delete</button></div></li>")});togglePages(1)},togglePages=function(a){var b=
$("#page-numbers a.selected");"prev"==a?(a=parseInt(b.attr("name")),1<a&&($("#page-numbers a").removeClass("selected"),$("#page-numbers #page-button-"+(a-1)).addClass("selected"),$(".paginated-container ul").removeClass("show selected").addClass("hidden"),$(".paginated-container #page-"+(a-1)).removeClass("hidden").addClass("show selected"))):"next"==a?(a=parseInt(b.attr("name")),0!=$("#page-button-"+(a+1)).length&&($("#page-numbers a").removeClass("selected"),$("#page-numbers #page-button-"+(a+1)).addClass("selected"),
$(".paginated-container ul").removeClass("show selected").addClass("hidden"),$(".paginated-container #page-"+(a+1)).removeClass("hidden").addClass("show selected"))):($("#page-numbers a").removeClass("selected"),$("#page-numbers #page-button-"+a).addClass("selected"),$(".paginated-container ul").removeClass("show selected").addClass("hidden"),$(".paginated-container #page-"+a).removeClass("hidden").addClass("show selected"))},editItem=function(a){loadLocalStorage().items.forEach(function(b,d){if(b.url==
a){var c=prompt("Edit this item",a);null!=c&&submit(c,d)}})},removeItem=function(a){var b=loadLocalStorage();loadLocalStorage().items.forEach(function(d,c){d.url==a&&b.items.splice(c,1)});saveLocalStorage(b,!0)},saveLocalStorage=function(a,b,d){window.localStorage.setItem("list",JSON.stringify(a));b?location.reload():b||(window.localStorage.setItem("lastSubmission",JSON.stringify(d)),window.location="./results.html")},submit=function(a,b){var d=!1,c,e=loadLocalStorage();"undefined"==typeof a?a=document.getElementById("link-address").value:
d=!0;validate(a).then(function(){d?(e.items[b].url=a,console.log("The url has been changed!")):(e.items.push({url:a}),c={url:a});saveLocalStorage(e,d,c)})["catch"](function(a){alert(a)})},validate=function(a){var b=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,d=loadLocalStorage(),c;return new Promise(function(e,f){"www."==a.substring(0,4)&&(a="https://"+a);b.test(a)?(d.items.forEach(function(b,c){b.url==a&&f("Link already exists")}),c=window.XMLHttpRequest?new XMLHttpRequest:
new ActiveXObject("Microsoft.XMLHTTP"),c.open("GET",a,!0),c.withCredentials="true",c.onreadystatechange=function(){4===c.readyState&&(console.log(c.status),404==c.status?f("The url '"+a+"' status is "+c.status+". Invalid."):e(!0))},c.send()):f("The url '"+a+"' is invalid.")})},quickPopulate=function(){for(var a={items:[]},b=0;500>b;b++)a.items[b]={url:"https://www.facebook.com/"+(b+1)};window.localStorage.setItem("list",JSON.stringify(a));location.reload()},clearAll=function(){window.localStorage.removeItem("list");
location.reload()};$(document).ready(function(){var a=window.localStorage.getItem("lastSubmission");a=JSON.parse(a);window.location.pathname.includes("/results.html")&&alert("Thank you for submitting your bookmark!");$("#results").append('<li><div class="col12"><a target="_blank" href="'+a.url+'">'+a.url+"</a></div></li>")});