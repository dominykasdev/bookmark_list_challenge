$(document).ready(function(){g();$("body").f("submit","#link-form",function(a){a.preventDefault();h()}).f("click","#page-numbers a",function(a){a.preventDefault();"prev"!=this.name&&"next"!=this.name&&($("#page-numbers a").b("selected"),$(this).a("selected"));k(this.name)})});function l(){var a=window.localStorage.getItem("list");a=JSON.parse(a);if(null==a||"undefined"==a)a={items:[]};return a}
function g(){var a=l(),c=$(".paginated-container"),f=0,b=0;a.items.forEach(function(d,e){0==e&&c.find("#page-numbers").append('<a id="page-button-prev" target="_self" href="" name="prev"><</a>');e==f&&(b++,c.append('<ul id="page-'+b+'" class="link-list"></ul>'),c.find("#page-numbers").append('<a id="page-button-'+b+'" target="_self" href="" name='+b+" >"+b+"</a>"),f+=20);e==a.items.length-1&&c.find("#page-numbers").append('<a id="page-button-next" target="_self" href="" name="next">></a>');$(".paginated-container #page-"+
b).append('<li><div class="col1">'+e+'</div><div class="col8"><a target="_blank" href="'+d.url+'">'+d.url+'</a></div><div class="col3"><button class="col6" onClick="editItem(\''+d.url+'\')">Edit</button><button class="col6" onClick="removeItem(\''+d.url+"')\">Delete</button></div></li>")});k(1)}
function k(a){var c=$("#page-numbers a.selected");"prev"==a?(a=parseInt(c.c("name")),1<a&&($("#page-numbers a").b("selected"),$("#page-numbers #page-button-"+(a-1)).a("selected"),$(".paginated-container ul").b("show selected").a("hidden"),$(".paginated-container #page-"+(a-1)).b("hidden").a("show selected"))):"next"==a?(a=parseInt(c.c("name")),0!=$("#page-button-"+(a+1)).length&&($("#page-numbers a").b("selected"),$("#page-numbers #page-button-"+(a+1)).a("selected"),$(".paginated-container ul").b("show selected").a("hidden"),
$(".paginated-container #page-"+(a+1)).b("hidden").a("show selected"))):($("#page-numbers a").b("selected"),$("#page-numbers #page-button-"+a).a("selected"),$(".paginated-container ul").b("show selected").a("hidden"),$(".paginated-container #page-"+a).b("hidden").a("show selected"))}
function h(){var a,c=!1,f,b=l();"undefined"==typeof a?a=document.getElementById("link-address").value:c=!0;m(a).then(function(){c?(b.items[void 0].url=a,console.log("The url has been changed!")):(b.items.push({url:a}),f={url:a});var d=c,e=f;window.localStorage.setItem("list",JSON.stringify(b));d?location.reload():d||(window.localStorage.setItem("lastSubmission",JSON.stringify(e)),window.location="./results.html")})["catch"](function(d){alert(d)})}
function m(a){var c=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,f=l(),b;return new Promise(function(d,e){"www."==a.substring(0,4)&&(a="https://"+a);c.test(a)?(f.items.forEach(function(n){n.url==a&&e("Link already exists")}),b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),b.open("GET",a,!0),b.withCredentials="true",b.onreadystatechange=function(){4===b.readyState&&(console.log(b.status),404==b.status?e("The url '"+a+"' status is "+
b.status+". Invalid."):d(!0))},b.send()):e("The url '"+a+"' is invalid.")})};$(document).ready(function(){var a=window.localStorage.getItem("lastSubmission");a=JSON.parse(a);window.location.pathname.includes("/results.html")&&alert("Thank you for submitting your bookmark!");$("#results").append('<li><div class="col12"><a target="_blank" href="'+a.url+'">'+a.url+"</a></div></li>")});
